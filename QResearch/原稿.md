これから、共役勾配法によるシュレディンガー方程式の解法を次のような順序で説明していきたいと思います。
まず、関数の極小値を求める方法として共役勾配法を説明します。
次に、シュレディンガー方程式が関数の極小化によって解くことができることを説明します。
最後に、シュレディンガー方程式を実際に共役勾配法を用いて解いていく様子を最急降下法と比較しながら見せていきたいと思います。
ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー
最初に共役勾配法の説明をしていこうと思います。共役勾配法は関数の極小値を求める方法です。関数の極小値を求める事の有用性を示すために、関数の極小化に帰着される問題の例を紹介したいと思います。
例えば、Ax=b, AX=lanbdaxの解は逆行列をとって計算する事が一般的です。
しかし、このような関数をとり、その関数の極小値を求めることによって解くことが可能です。
それぞれの関数が極小値を取るときのxが求める解となります。
このように、ある問題が関数の極小値を求めることに帰着する事は非常に多いのです。
以上から関数の極小値をいかにして効率的に求めるかという事が重要となってきます。
ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー
そこで、関数の極小値を求める方法として共役勾配法を紹介していきたいと思います。
関数の極小値を求める方法として有名なものに、最急降下方があります。
これは各更新においてその点の勾配方向に値を更新することで極小値を求める方法です。
これは次のような動きになります。
見ていただければわかるようにジグザグに更新しているので似た方向への探索が多いことが分かリマス。
よってこれを減らすことができればより効率的に探索することが可能であると言えます。
共役勾配法は、このジグザグな動きを減らすことで似た方向への探索を減らし、より効率的に極小値を求める方法です。

右上の式のように、共役勾配法では最急降下法の更新方向であるrkを用います。そして、新しい更新が古い更新と共役であるように補正を行う項がBkpkです。
このように共役方向に更新方向を補正することでより効率的に探索を行うことができます。
また、共役勾配法の優れている点はk+1回目の更新は、k回目までの情報を考慮して行うため、K回の探索は、K次元の全探索と等しくなる点です。
最急降下法が鞍点に収束することがある一方で、共役勾配法は有限回の回数で極小値へたどり着くことができます。
以上のように、共役勾配法は、最急降下法に比べて効率的であると言えます。
今回は共役勾配法を今から説明する関数の極小化に用いたいと思います。
ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー
次にシュレディンガー方程式から、極小化する関数を求めたいと思います。
一般的にシュレディンガー方程式は右のように表すことができます。
このシュレディンガー方程式の解は変分原理によってFという汎関数の極小点でもって求まります。
極小化すべき関数Fが汎関数であるため、空間を離散化する事で、psiをベクトルにし、下の式のように表します。
このように汎関数から下の関数に帰着することができこの式を極小化することでシュレディンガー方程式の解を求めることができます。
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
以上から、シュレディンガー方程式を解くのにおいて極小化すべき関数と、極小化する方法を決めることができました。
それでは例として次の二つを共役勾配法で解きます。
結果を最急降下法と比較することで共役勾配法で解く事の効率の高さを示して行きたいと思います。
はじめに答えがわかっている三次元調和振動子を共役勾配法で解くことによって、効率の高さだけでなく、正しく解けていることを確認したい思います。
次に答えがわかっていないシュレディンガー方程式を解くことによって、この方法が汎関数において適用できており、共役勾配法でシュレディンガー方程式を解くことが汎用性の高い方法であることを示したいと思います。
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
共役勾配法の探索の様子を示すために、各更新でのpsiの様子をグラフに示しました。
また、共役勾配法の効率の高さを示すために、左側に最急降下法のグラフ、右側に共役勾配法のグラフを表示しました。
下はFの値で、3次元調和振動子では1.5が正しい値となります。
それでは、共役勾配法によって、グラフとFの値が収束していく様子を見せたいと思います。
各点において乱数をとった物を初期状態としたので、まだ二つのグラフの差はありません。
次が1回目の更新を行なった物です。共役勾配法において1回目の更新には考慮すべき過去の更新がないため、最急効果法と共役勾配法の間でまださは生まれていません。
2回目、5回目と更新を行なっていくことによって、両者の間に差が出ているのがわかると思います。予測した通り、共役勾配法の方が早く正しい値に収束していっています。
30回目になると共役勾配法の方はほとんど収束しきっていることがわかります。
次は100回目と5000回目をまとめた物です。共役勾配法の方は30回目の時点で十分に収束しきっていたため、30-5000回にかけて全く変化していないことがわかります。
一方で、最急降下法の方はまだ収束する余地はあるものの、5000回目でも共役勾配法の30回目より制度が劣っていることがわかります。
このように、答えがわかっている3次元調和振動子によって、共役勾配法の有用性を示すことができました。
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
次に、答えがわかっていないシュレディンガー方程式を共役勾配法で解いて行きたいと思います。
先ほどと同じように、ランダムな状態から始めます。
30回目には共役勾配法の方のグラフが収束の動きを見せ始めていることがわかります。
100回目になるとグラフの様子から共役勾配法の方は収束しているように見えますが、最急降下法の方はそのようには見えません。
2000回目と100回目の共役勾配法のグラフとFの値に差がないことから100回目の時点で十分に収束していたことがわかります
一方で2000回目でようやく最急降下法の方も共役勾配法の100回目のグラフに近い形で収束しました。
このように、共役勾配法と最急降下法には大きな差が生まれていることがわかります。
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
共役勾配法によって効率的に探索することによって、計算量の大きい行列計算の回数を大きく減らすことができるため、最終的に共役勾配法と最急降下法の間で大きな計算時間の差が生まれました。
今回の発表で私は、関数の極小化の方法として共役勾配法の紹介を行い、それを用いることでシュレディンガー方程式を効率的に解くことができることを示しました。
ご静聴ありがとうございました。
